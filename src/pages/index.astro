---
import { getCollection } from "astro:content";
import AppShell from "../components/AppShell.astro";
import CardProject from "../components/CardProject.astro";
import PostListItem from "../components/PostListItem.astro";

// Get latest projects and thoughts
const projects = await getCollection("projects");
const thoughts = await getCollection("thoughts");

// Sort and limit
const latestProjects = projects
  .sort((a, b) => b.data.year - a.data.year)
  .slice(0, 6);

const latestThoughts = thoughts
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.getTime() - a.data.date.getTime())
  .slice(0, 5);
---

<AppShell
  title="Adrian Tang"
  description="Personal site of Adrian Tang - developer, writer, and builder of things."
>
  <!-- Intro Section -->
  <section class="mb-12">
    <div class="max-w-2xl">
      <h1 class="text-3xl md:text-4xl font-bold text-heading mb-4">
        Adrian Tang
      </h1>
      <p class="text-lg text-text leading-relaxed mb-6">
        Short, punchy line goes here. I enjoy building things that matter and
        writing about the journey along the way.
      </p>
      <div class="flex flex-wrap gap-4 text-sm">
        <a
          href="/projects"
          class="text-accent hover:text-heading transition-colors font-medium"
        >
          Projects
        </a>
        <span class="text-muted">·</span>
        <a
          href="/thoughts"
          class="text-accent hover:text-heading transition-colors font-medium"
        >
          Thoughts
        </a>
        <span class="text-muted">·</span>
        <a
          href="/contact"
          class="text-accent hover:text-heading transition-colors font-medium"
        >
          Contact
        </a>
      </div>
    </div>
  </section>

  <!-- Latest Projects -->
  {
    latestProjects.length > 0 && (
      <section class="mb-12">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-semibold text-heading">Latest Projects</h2>
          <a
            href="/projects"
            class="text-sm text-accent hover:text-heading transition-colors font-medium"
          >
            View all →
          </a>
        </div>

        <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
          {latestProjects.map((project) => (
            <CardProject
              title={project.data.title}
              year={project.data.year}
              summary={project.data.summary}
              stack={project.data.stack}
              href={`/projects/${project.slug}`}
              featured={project.data.featured}
            />
          ))}
        </div>
      </section>
    )
  }

  <!-- Latest Thoughts -->
  {
    latestThoughts.length > 0 && (
      <section class="mb-12">
        <div class="flex items-center justify-between mb-6">
          <h2 class="text-2xl font-semibold text-heading">Latest Thoughts</h2>
          <a
            href="/thoughts"
            class="text-sm text-accent hover:text-heading transition-colors font-medium"
          >
            View all →
          </a>
        </div>

        <div class="space-y-0">
          {latestThoughts.map((post) => (
            <PostListItem
              title={post.data.title}
              href={`/thoughts/${post.slug}`}
              date={post.data.date}
              category={post.data.category}
              summary={post.data.summary}
            />
          ))}
        </div>
      </section>
    )
  }

  <!-- Divider -->
  <div class="border-t border-muted/20 my-12"></div>

  <!-- Footer Note -->
  <section class="text-center">
    <p class="text-sm text-muted">
      Built with <a
        href="https://astro.build"
        class="text-accent hover:text-heading transition-colors">Astro</a
      >
      and <a
        href="https://tailwindcss.com"
        class="text-accent hover:text-heading transition-colors">Tailwind CSS</a
      >
    </p>
  </section>
</AppShell>
