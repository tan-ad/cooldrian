---
import { getCollection } from "astro:content";
import AppShell from "../../components/AppShell.astro";
import CardProject from "../../components/CardProject.astro";

const projects = await getCollection("projects");

// Sort by featured status first, then alphabetically by title
const sortedProjects = projects.sort((a, b) => {
  if (a.data.featured && !b.data.featured) return -1;
  if (!a.data.featured && b.data.featured) return 1;
  return a.data.title.localeCompare(b.data.title);
});
---

<AppShell
  title="Projects"
  description="A collection of projects I've built over the years."
>
  <div class="mb-8">
    <h1 class="text-3xl md:text-4xl font-bold text-heading mb-4 mt-0 md:mt-8">
      Projects
    </h1>
    <p class="text-lg text-text leading-relaxed max-w-2xl">
      A collection of projects I've built. From small experiments to larger
      applications, each one taught me something new and helped me grow as a
      developer.
    </p>
  </div>

  <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
    {
      sortedProjects.map((project) => (
        <CardProject
          title={project.data.title}
          summary={project.data.summary}
          stack={project.data.stack}
          href={
            project.body && project.body.trim()
              ? `/projects/${project.slug}`
              : undefined
          }
          featured={project.data.featured}
        />
      ))
    }
  </div>

  {
    projects.length === 0 && (
      <div class="text-center py-12">
        <p class="text-muted">No projects yet. Check back soon!</p>
      </div>
    )
  }
</AppShell>
